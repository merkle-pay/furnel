{
    debug
}

# Local development
:80 {
    # API routes
    handle /api/* {
        reverse_proxy api:3000
    }

    # Temporal UI (basic auth protected)
    handle /temporal/* {
        basic_auth {
            admin {$CADDY_ADMIN_HASH}
        }
        uri strip_prefix /temporal
        reverse_proxy temporal-ui:8080
    }

    # PgWeb (basic auth protected)
    handle /db/* {
        basic_auth {
            admin {$CADDY_ADMIN_HASH}
        }
        uri strip_prefix /db
        reverse_proxy pgweb:8081
    }

    # Health check
    handle /health {
        reverse_proxy api:3000
    }

    # Default
    handle {
        respond "Payment API" 200
    }
}
